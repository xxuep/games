<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Simple PHP Web Proxy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial; margin: 0; display: flex; flex-direction: column; height: 100vh; }
    header { padding: 10px; background:#0b74da; color:white; display:flex; gap:8px; align-items:center; }
    input[type="text"] { flex:1; padding:8px; border-radius:6px; border:none; }
    button { padding:8px 12px; border-radius:6px; border:none; background:white; color:#0b74da; cursor:pointer; font-weight:600; }
    #frame { flex:1; border:0; width:100%; }
    .small { font-size:12px; opacity:.9; }
  </style>
</head>
<body>
  <header>
    <form id="frm" style="display:flex; width:100%;" onsubmit="return go();">
      <input id="url" type="text" placeholder="https://example.com" spellcheck="false" />
      <button type="submit">Go</button>
    </form>
    <div style="margin-left:10px" class="small">Proxy</div>
  </header>

  <iframe id="frame" sandbox="allow-same-origin allow-scripts allow-forms"></iframe>

  <script>
    // If you want to load immediately from query param ?u=..., uncomment:
    (function(){
      const params = new URLSearchParams(location.search);
      const u = params.get('u');
      if(u) document.getElementById('url').value = u, go();
    })();

    function go(){
      const url = document.getElementById('url').value.trim();
      if(!url) return false;
      // Basic normalization
      let final = url;
      if(!/^https?:\/\//i.test(final)) final = 'http://' + final;
      // The proxy endpoint is proxy.php; pass the target URL as "url" param.
      // We use encodeURIComponent to keep safe.
      const proxyUrl = 'proxy.php?url=' + encodeURIComponent(final);
      document.getElementById('frame').src = proxyUrl;
      // Update the address bar so link-sharing works
      try{
        history.replaceState(null, '', '?u=' + encodeURIComponent(final));
      }catch(e){}
      return false;
    }

    // Clicks inside the iframe will be handled by proxy link rewriting (server-side).
  </script>
</body>
</html>
